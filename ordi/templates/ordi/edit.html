
{% extends 'base.html' %}


{% block title %}
  Karteikarte
{% endblock %}


{% block content %}
    <div>
        {% include 'ordi/_person.html' %}
        {% include 'ordi/_tier.html' %}

        <div class="huge-gap"></div>
    </div>

    <div class="behandlungen" style="height: 40%; overflow: scroll">
        <table class="liste">
            <tr>
                <th style="width: 10%">Datum</th>
                <th style="width: 10%">Gewicht</th>
                <th style="width: 20%">Diagnose</th>
                <th style="width: 10%">Laborwerte1</th>
                <th style="width: 10%">Laborwerte2</th>
                <th style="width: 10%">Arzneien</th>
                <th style="width: 10%">Arzneimittel</th>
                <th style="width: 10%">Impfungen</th>
                <th style="width: 10%">&nbsp;</th>
            </tr>
            {% for behandlung in behandlungen %}
            <form method="post" action="{{ url_for('ordi.editbehandlung', id=karteikarte['id'], behandlung_id=behandlung['id']) }}">
            <tr class="behandlung">
                <td><input size="8" class="date" name="behandlungsdatum" id="behandlungsdatum{{behandlung['id']}}" value="{{ behandlung['behandlungsdatum'] }}"></td>
                <td><input size="3" name="gewicht_Kg" id="gewicht_Kg{{behandlung['id']}}" value="{{ behandlung['gewicht_Kg'] }}"></td>
                <td><textarea style="width: 100%" name="diagnose" id="diagnose{{behandlung['id']}}">{{ behandlung['diagnose'] }}</textarea></td>
                <td><textarea style="width: 100%" name="laborwerte1" id="laborwerte1{{behandlung['id']}}">{{ behandlung['laborwerte1'] }}</textarea></td>
                <td><textarea style="width: 100%" name="laborwerte2" id="laborwerte2{{behandlung['id']}}">{{ behandlung['laborwerte2'] }}</textarea></td>
                <td><textarea style="width: 100%" name="arzneien" id="arzneien{{behandlung['id']}}">{{ behandlung['arzneien'] }}</textarea></td>
                <td><textarea style="width: 100%" name="arzneimittel" id="arzneimittel{{behandlung['id']}}">{{ behandlung['arzneimittel'] }}</textarea></td>
                <td><textarea style="width: 100%" name="impfungen_extern" id="impfungen_extern{{behandlung['id']}}">{{ behandlung['impfungen_extern'] }}</textarea></td>
                <td><input type="submit" value="Bearbeiten"></td>
            </tr>
            </form>
            {% endfor %}
            <form method="post" action="{{ url_for('ordi.newbehandlung', id=karteikarte['id']) }}">
            <tr>
                <td><input size="8" class="date" name="behandlungsdatum" id="behandlungsdatum" value="{{ request.form['behandlungsdatum'] or behandlungsdatum }}"></td>
                <td><input size="3" name="gewicht_Kg" id="gewicht_Kg" value="{{ request.form['gewicht_Kg'] }}"></td>
                <td><textarea style="width: 100%" name="diagnose" id="diagnose">{{ request.form['diagnose'] }}</textarea></td>
                <td><textarea style="width: 100%" name="laborwerte1" id="laborwerte1">{{ request.form['laborwerte1'] }}</textarea></td>
                <td><textarea style="width: 100%" name="laborwerte2" id="laborwerte2">{{ request.form['laborwerte2'] }}</textarea></td>
                <td><textarea style="width: 100%" name="arzneien" id="arzneien">{{ request.form['arzneien'] }}</textarea></td>
                <td><textarea style="width: 100%" name="arzneimittel" id="arzneimittel">{{ request.form['arzneimittel'] }}</textarea></td>
                <td><textarea style="width: 100%" name="impfungen_extern" id="impfungen_extern">{{ request.form['impfungen_extern'] }}</textarea></td>
                <td><input type="submit" value="Speichern"></td>
            </tr>
            </form>
        </table>
    </div>

    <script>
        $(document).ready(function(){
            $( ".person input" ).prop( "disabled", true );
            $( ".person select" ).prop( "disabled", true );

            $( ".tier input" ).prop( "disabled", true );
            $( ".tier select" ).prop( "disabled", true );

            $( ".behandlung input" ).prop( "disabled", false );
            $( ".behandlung select" ).prop( "disabled", false );

            $( "input[type=submit]" ).prop( "disabled", false );
            
            $.datepicker.setDefaults($.datepicker.regional["de"]);
            $(".date").datepicker({ dateFormat: "yy-mm-dd" });
        });
    </script>
{% endblock %}
